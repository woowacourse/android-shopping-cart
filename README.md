# android-shopping-cart

## 1단계

Fragment
장바구니 페이지
상품 상세 페이지
상품 목록 페이지

### 기능 요구 사항

- [x] 사용자는 상품 목록의 상품을 장바구니에 추가할 수 있다.
- [x] 상품을 클릭하면 상품 상세로 이동한다.
- [x] 상품 상세에서 장바구니에 상품을 담을 수 있다.
- [x] 장바구니에서 원하는 상품을 삭제할 수 있다.

### 프로그래밍 요구 사항

- 상품 목록은 RecyclerView에 GridLayoutManager를 설정하여 구현한다.
- ListAdapter, DiffUtil을 사용하지 않는다.
- 이미지 로딩을 위해 Glide를 사용한다.

## 2단계

### 기능 요구 사항

- 데이터 로딩 전략을 적용한다.
- [x] 상품 목록에서 더보기 버튼을 눌러 추가 로드할 수 있다. (20개 기준)
- [x] 장바구니 목록은 페이지네이션이 되어야 한다. (5개 기준)

### 프로그래밍 요구 사항

- 데이터 로딩 전략에 대한 적절한 테스트 방법을 선택하여 테스트를 작성한다.

## 3단계

* 상품 목록에서 장바구니에 담을 상품의 수를 선택할 수 있다. (B마트 UX 참고)
    * `+`버튼을 누르면 장바구니에 상품이 추가됨과 동시에 수량 선택 버튼이 노출된다.
    * 상품 목록의 상품 수가 변화하면 장바구니에도 반영되어야 한다.
    * 장바구니의 상품 수가 변화하면 상품 목록에도 반영되어야 한다.
* 상품 상세에서 장바구니에 담을 상품의 수를 선택할 수 있다.

* 상품 id 와 해당 삼풍 개수를 가진 데이터 클래스
* 위 데이터 클래스를 그대로 불러오는 데이터 소스, 레포지토리
* 위에서 불러오는 객체를 뷰모델이 LiveData 로 가지고 있는다.
* 상품 목록에서 위 객체를 옵저빙.

* 상품 목록에서 어댑터에 쓰이는 데이터를 그냥 ui 도 가지고 있는 것으로 해야 하나?
* 그래서 레포지토리에서 데이터를 가지고 올 때, count 프로퍼티를 가지고 있는 하나의 객체로 만들어야 되나?
* 그러면 쇼핑 목록 레포지토리가 생성자 파라미터로 productIdsCountRepository 에 접근해서
* ui 모델로 바꿀 때, count 를 포함해서 내보내면 될 것 같은데?
* 그래서 ui model 로 변경해주는 것을 해야 할 것 같은데?


### 4단계

* 최근 본 상품이 있는 경우 상품 목록 상단에서 10개까지 확인할 수 있다. 
* 마지막으로 본 상품 1개를 상품 상세 페이지에서 확인할 수 있다. 
* 마지막으로 본 상품을 선택했을 때는 마지막으로 본 상품이 보이지 않는다. 
* 마지막으로 본 상품 페이지에서 뒤로 가기를 하면 상품 목록으로 이동한다. 
* 앱이 재시작돼도 최근 본 상품 목록과 장바구니 데이터는 유지돼야 한다.

* 로컬 데이터 유지를 위해 Room을 사용한다. 
* 상품 목록의 HTTP Client를 구현한다. 
* MockWebServer를 사용하여 테스트 환경을 만든다.

### 리뷰 반영
- [x] Thread 를 ViewModel 에서 사용할 필요가 있을까? DataSOurce 로 이동시켜보기
- [x] Thread { ... }.join 을?? 
- [x] Result 값을 리턴값으로 활용한다면, 에러가 발생했을 때 단순앱을 죽이는 것이 아니라 사용자에게 에러를 알리고 앱을 유지시킬 수 있겠다는 생각이 듭니다!
  - [x] ProductListFragment 에 적용 
  - [x] ShoppingCartFragment 에 적용
  - [x] ProductDetailFragment 에 적용
- [x] ui state 와 event 를 분리하고 인터페이스도 분리해서 MutableLiveData 와 LiveData 의 boilerplate 제거.
  - [x] ProductListFragment 에 적용.
  - [x] ShoppingCartFragment 에 적용.
  - [x] ProductDetailFragment 에 적용.
    - [x] 디미터 법칙 위반을 줄이기 위해, ui state 에서 간단한 로직 처리.
  - [x] ShoppingCartFragment 에 적용.
    - [x] 디미터 법칙
  - [x] ProductDetailFragment 에 적용.
    - [x] 디미터 법칙

- [x] 리사이클러뷰를 리스트 어댑터와 diffutil 로 바꾸기. 차이점 알아보기
- [x] Repository, DataSource 에서 Result 객체로 결과를 받는다면, 현재와 같은 구현들이 수정이 될 수 있겠다는 생각이 듭니다~💪
- [x] 화면이 깜빡이는 이유가 여기에 있었네요😅
  아이템을 카트에 넣거나, 빼거나, 리스트에 변경이 생길 경우 notifyDataSetChanged()으로 모든 아이템들을 갱샌해주고 있군요!
  notifyXXX 에는 여러가지 함수들이 존재를 하는데, 각각의 함수별로 차이점을 살펴보시면 좋을 것 같습니다!💪
- [ ] 테스트 코드의 경우 어떤 테스트인지 확실하게 알 수 있게 행위 -> 결과 형식으로 네이밍을 정해보는 것도 좋을 것 같다
- [x] 데이터 베이스 테스트 test fixture
- [x] 로그용 Log.d, println 지우기
- [ ] dao, api service, datasource, repository 각각 어떠한 로직이 들어가야 하나?
- [x] replace()와 add(), addToBackStack()의 동작과 차이점. 해당 이슈 관련 오류
